{"version":3,"sources":["file:///Users/ADMIN/Desktop/FruitLineSaga_Cocos/FruitLineSaga/FruitLineSaga_Cocos/assets/Leaderboard/Script/LeaderboardHandle.ts"],"names":["_decorator","Component","instantiate","Node","Prefab","ItemLeaderboard","GameCenterController","ccclass","property","LeaderboardHandle","type","tooltip","DISTANCE","TOTAL_ROW","show","node","active","container","removeAllChildren","gameCenter","getLeaderBoard","then","data","renderLeaderboard","i","length","item","el","prefabItem","addChild","setPosition","getComponent","init","metadata","citizenName","point","index","lastChild","children","personalItem","position","y","scale","x","current","find","userId","user","userID","hidden"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Node, Prefab } from 'cc';\r\nimport { ItemLeaderboard } from './ItemLeaderboard';\r\nimport { GameCenterController, LeaderBoard } from '../../Script/GameCenter/GameCenterController';\r\n\r\n\r\n\r\n\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('LeaderboardHandle')\r\nexport class LeaderboardHandle extends Component {\r\n    @property({\r\n        type: GameCenterController,\r\n        tooltip: 'Game center'\r\n    })\r\n    private gameCenter: GameCenterController;\r\n\r\n    @property({\r\n        type: Prefab,\r\n        tooltip: 'Prefab item leaderboard'\r\n    })\r\n    private prefabItem: Prefab;\r\n\r\n    @property({\r\n        type: Node\r\n    })\r\n    private container: Node;\r\n\r\n    @property({\r\n        type: ItemLeaderboard\r\n    })\r\n    private personalItem: ItemLeaderboard;\r\n    private readonly DISTANCE: number = 110;\r\n    private readonly TOTAL_ROW: number = 3;\r\n\r\n    public show(): void {\r\n        this.node.active = true;\r\n        this.container.removeAllChildren();\r\n        this.gameCenter.getLeaderBoard(0).then((data) => this.renderLeaderboard(data));\r\n    }\r\n\r\n    public renderLeaderboard(data: LeaderBoard[]): void {\r\n        for (let i = 0; i < this.TOTAL_ROW; i++) {\r\n            if (i >= data.length) break;\r\n            let item = data[i];\r\n            let el = instantiate(this.prefabItem);\r\n            this.container.addChild(el);\r\n            el.setPosition(0, -i * this.DISTANCE);\r\n            el.getComponent(ItemLeaderboard).init(item.metadata.citizenName, `${item.point}`, item.index, false);\r\n        }\r\n\r\n        let lastChild = this.container.children[this.container.children.length - 1];\r\n        this.personalItem.node.setPosition(0, (lastChild.position.y + 75) * this.personalItem.node.scale.x);\r\n\r\n        let current = data.find((item) => item.userId === this.gameCenter.user.userID);\r\n        if (current) {\r\n            this.personalItem.init(current.metadata.citizenName, `${current.point}`, current.index, true);\r\n            this.personalItem.node.active = true;\r\n        }\r\n    }\r\n\r\n    public hidden(): void {\r\n        this.node.active = false;\r\n    }\r\n}\r\n\r\n"]}