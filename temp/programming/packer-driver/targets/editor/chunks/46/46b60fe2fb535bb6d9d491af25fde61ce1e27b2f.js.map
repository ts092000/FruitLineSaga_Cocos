{"version":3,"sources":["file:///Users/ADMIN/Desktop/FruitLineSaga_Cocos/FruitLineSaga/FruitLineSaga_Cocos/assets/Script/PrefabControl/Cell.ts"],"names":["_decorator","Animation","Component","Node","Sprite","tween","Vec3","CellType","FruitType","Constants","ccclass","property","Cell","type","tooltip","coordinates","row","col","isSelecting","Apple","cellType","Empty","start","spriteFruit","node","setPosition","setCellType","Hint","to","scale","Fruit","active","getComponent","enabled","playAnimation","onTouchStart","setCoordinates","CELL_SIZE","getCoordinates","animation","play","stopAnimation","stop","setScale","setSpriteFruit","spriteFrame","setTypeFruit","getTypeFruit","hiddenCell","off","EventType","TOUCH_START","swirlNode","ANIMATION_NAME","FruitHidden","resetCell","getCellType"],"mappings":"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","sourcesContent":["import { _decorator, Animation, Component, Node, Sprite, SpriteFrame, tween, Vec3 } from 'cc';\r\nimport { CellType, Coordinates, FruitType } from '../Utils/DataTypes';\r\nimport { Constants } from '../Utils/Constants';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Cell')\r\nexport class Cell extends Component {\r\n    @property({\r\n        type: Sprite,\r\n        tooltip: 'Sprite fruil'\r\n    })\r\n    private spriteFruit: Sprite;\r\n\r\n    @property({\r\n        type: Animation,\r\n        tooltip: 'Animation cell'\r\n    })\r\n    private animation: Animation;\r\n\r\n    @property({\r\n        type: Node,\r\n        tooltip: 'Swirl node'\r\n    })\r\n    private swirlNode: Node;\r\n\r\n    private coordinates: Coordinates = { row: 0, col: 0 };\r\n    private isSelecting: boolean = false;\r\n    private type: FruitType = FruitType.Apple;\r\n    private cellType: CellType = CellType.Empty;\r\n\r\n    protected start(): void {\r\n        this.spriteFruit.node.setPosition(20, 20);\r\n    }\r\n\r\n    public setCellType(type: CellType): void {\r\n        this.cellType = type;\r\n        if (type === CellType.Hint) {\r\n            tween(this.spriteFruit.node).to(0.1, { scale: new Vec3(0.1, 0.1, 1) }).start();\r\n        }\r\n        if (type === CellType.Fruit) {\r\n            tween(this.spriteFruit.node).to(0.1, { scale: new Vec3(0.18, 0.18, 1) }).start();\r\n\r\n        }\r\n\r\n        this.spriteFruit.node.active = !(this.cellType === CellType.Empty);\r\n        this.node.getComponent(Sprite).enabled = this.cellType === CellType.Empty;\r\n    }\r\n\r\n    public playAnimation(): void {\r\n        this.onTouchStart();\r\n    }\r\n\r\n    public setCoordinates(coordinates: Coordinates): void {\r\n        this.coordinates = { ...coordinates };\r\n        this.node.setPosition(coordinates.col * Constants.CELL_SIZE, (8 - coordinates.row) * Constants.CELL_SIZE);\r\n    }\r\n\r\n    public getCoordinates(): Coordinates {\r\n        return this.coordinates;\r\n    }\r\n\r\n    private onTouchStart(): void {\r\n        this.isSelecting = !this.isSelecting;\r\n        if (this.isSelecting) this.animation.play();\r\n        else this.stopAnimation();\r\n    }\r\n\r\n    public stopAnimation(): void {\r\n        this.isSelecting = false;\r\n        this.animation.stop();\r\n\r\n        this.spriteFruit.node.setScale(0.18, 0.18);\r\n    }\r\n\r\n    public setSpriteFruit(spriteFrame: SpriteFrame): void {\r\n        this.spriteFruit.spriteFrame = spriteFrame;\r\n    }\r\n\r\n    public setTypeFruit(type: FruitType): void {\r\n        this.type = type;\r\n    }\r\n\r\n    public getTypeFruit(): FruitType {\r\n        return this.type;\r\n    }\r\n\r\n    public hiddenCell(): void {\r\n        this.node.off(Node.EventType.TOUCH_START);\r\n        this.swirlNode.active = true;\r\n        this.animation.play(Constants.ANIMATION_NAME.FruitHidden);\r\n    }\r\n\r\n    public resetCell(): void {\r\n        this.coordinates = { row: 0, col: 0 };\r\n        this.isSelecting = false;\r\n        this.setTypeFruit(FruitType.Apple);\r\n        this.setCellType(CellType.Empty);\r\n        this.animation.stop();\r\n        this.node.off(Node.EventType.TOUCH_START);\r\n    }\r\n\r\n    public getCellType(): CellType {\r\n        return this.cellType;\r\n    }\r\n}\r\n\r\n"]}